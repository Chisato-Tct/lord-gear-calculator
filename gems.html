<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>宝石計算ツール</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<h1>宝石計算ツール</h1>
<p>現在レベルと目標レベルを選択してください。（Lv2〜Lv14）</p>

<table>
  <thead>
    <tr>
      <th>項目</th>
      <th>現在</th>
      <th>目標</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>宝石レベル</td>
      <td>
        <select id="current-level"></select>
      </td>
      <td>
        <select id="target-level"></select>
      </td>
    </tr>
  </tbody>
</table>

<h2>所持素材</h2>
<div class="materials">
  <label>
    Charm Guides
    <input type="number" id="have-guides" value="0">
  </label>
  <label>
    Charm Designs
    <input type="number" id="have-designs" value="0">
  </label>
</div>

<button onclick="calculate()">計算する</button>

<h2>計算結果</h2>
<div id="result">ここに結果が表示されます</div>

<script>
/* ===== マスターデータ =====
   Lv1は除外、Lv2〜14のみ
*/
const GEM_MASTER = {
  2: { guides: 40,  designs: 15 },
  3: { guides: 60,  designs: 40 },
  4: { guides: 80,  designs: 100 },
  5: { guides: 100, designs: 200 },
  6: { guides: 120, designs: 300 },
  7: { guides: 140, designs: 400 },
  8: { guides: 200, designs: 400 },
  9: { guides: 300, designs: 400 },
  10:{ guides: 420, designs: 420 },
  11:{ guides: 560, designs: 420 },
  12:{ guides: 580, designs: 600 },
  13:{ guides: 610, designs: 780 },
  14:{ guides: 645, designs: 960 }
};

/* ===== プルダウン初期化 ===== */
const currentSel = document.getElementById("current-level");
const targetSel  = document.getElementById("target-level");

Object.keys(GEM_MASTER).forEach(lv => {
  const opt1 = document.createElement("option");
  opt1.value = lv;
  opt1.textContent = `Lv${lv}`;
  currentSel.appendChild(opt1);

  const opt2 = document.createElement("option");
  opt2.value = lv;
  opt2.textContent = `Lv${lv}`;
  targetSel.appendChild(opt2);
});

/* ===== 計算処理 ===== */
function calculate() {
  const cur = Number(currentSel.value);
  const tgt = Number(targetSel.value);

  if (tgt <= cur) {
    document.getElementById("result").innerHTML =
      "目標レベルは現在より高くしてください";
    return;
  }

  let needGuides = 0;
  let needDesigns = 0;

  for (let lv = cur + 1; lv <= tgt; lv++) {
    needGuides  += GEM_MASTER[lv].guides;
    needDesigns += GEM_MASTER[lv].designs;
  }

  const haveGuides  = Number(document.getElementById("have-guides").value);
  const haveDesigns = Number(document.getElementById("have-designs").value);

  const lackGuides  = needGuides  - haveGuides;
  const lackDesigns = needDesigns - haveDesigns;

  const red = v => v > 0 ? `<span class="negative">${v}</span>` : 0;

  document.getElementById("result").innerHTML = `
    <p>必要 Charm Guides：${needGuides}</p>
    <p>必要 Charm Designs：${needDesigns}</p>
    <hr>
    <p>不足 Charm Guides：${red(lackGuides)}</p>
    <p>不足 Charm Designs：${red(lackDesigns)}</p>
  `;
}
</script>

</body>
</html>
